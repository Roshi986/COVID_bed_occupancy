# COVID_bed_occupancy

Code for bed occupancy and patient pathway analyses

## Datasets

The following datasets are in the "data" folder:
- `average_los_by_pathway_X`: average LoS and standard deviation for each
stage in all identified full bed pathways, either for UCLH or CO-CIN
- `average_los_by_outcome_X`: average LoS and standard deviation by bed type,
either for UCLH or CO-CIN
- `uk_hospital_data`: bed occupancy data for England. This is extracted from
the publicly available [UK dashboard](https://coronavirus.data.gov.uk/)
- `uclh_occupancy`: bed occupancy data for UCLH

The "raw_cocin" subfolder contains the raw CO-CIN distributions for each stage
in each bed pathway. These were generated in another paper, please [REF] for a
complete description.

## Code

The "code" folder contains the following scripts:
- `core_model_functions`: the function used to run the model, a wrapper function
used for multiple runs, and a plotting function
- `paths_table_to_blocks`: script used to convert the LoS datasets in "data" to
R objects that can then be used with the model

## Reports

In the root of the directory, the following Rmd files are used to generate all
the analysis for our paper:
- `pathways_paper_run_model`: runs the model for all the scenarios considered in
our paper (UCLH, England, NHS Regions etc...)
- `pathways_paper_fitting`: runs the model to find the best-fitting LoS values
by bed type for each NHS Region (see our paper for details)
- `pathways_paper_explore`: uses the results produced by the first two Rmd files
to generate all of the figures and tables included in our paper

NOTE: the Rmd files used to generate results take several hours to run! This is
due to the extremely large number of patients in the England dataset. If you
wish to run these files quickly to check reproducibility, we recommend reducing
the number of model runs at the England and NHS Regions level from 100 to 5.

## Outputs

The "outputs" folder contains the saved results generated by the Rmd reports.
The subfolder "results" contains model results generated by the `pathways_paper_run_model`
and `pathways_paper_fitting` reports.
The subfolder tables contains the fitted LoS values generated by the 
`pathways_paper_fitting` report.
The subfolder "figures" contains figures generated by the `pathways_paper_explore`
report.
